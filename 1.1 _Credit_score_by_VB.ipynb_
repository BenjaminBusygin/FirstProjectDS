{"cells":[{"cell_type":"markdown","metadata":{"id":"Uffz8BvIgPx7"},"source":["**1.Загрузка и разведочный анализ данных**"]},{"cell_type":"markdown","metadata":{"id":"cbY64e3jgc9P"},"source":["Импорт библиотеки Pandas"]},{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":1347,"status":"ok","timestamp":1677556905376,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"d2yqo-otfoFK"},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","from matplotlib import pyplot as plt\n","from sklearn.linear_model import LogisticRegression\n","\n","import warnings\n","warnings.filterwarnings(\"ignore\")"]},{"cell_type":"markdown","metadata":{"id":"rubFE0bshy-A"},"source":["Подключение к БД"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1144,"status":"ok","timestamp":1677556914135,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"7w4MtYrBg9um","outputId":"24b28b99-7b3b-4c47-e35e-60ac4b4d8129"},"outputs":[{"output_type":"stream","name":"stdout","text":["--2023-02-28 04:01:51--  https://storage.yandexcloud.net/cloud-certs/CA.pem\n","Resolving storage.yandexcloud.net (storage.yandexcloud.net)... 213.180.193.243, 2a02:6b8::1d9\n","Connecting to storage.yandexcloud.net (storage.yandexcloud.net)|213.180.193.243|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 3579 (3.5K) [application/x-x509-ca-cert]\n","Saving to: ‘/root/.postgresql/root.crt’\n","\n","/root/.postgresql/r 100%[===================>]   3.50K  --.-KB/s    in 0s      \n","\n","2023-02-28 04:01:52 (711 MB/s) - ‘/root/.postgresql/root.crt’ saved [3579/3579]\n","\n"]}],"source":["!mkdir -p ~/.postgresql && \\\n","wget \"https://storage.yandexcloud.net/cloud-certs/CA.pem\" \\\n","    --output-document ~/.postgresql/root.crt && \\\n","chmod 0600 ~/.postgresql/root.crt"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16882,"status":"ok","timestamp":1677556933008,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"Lzs5wJqshDFN","outputId":"b7560bcc-0bb3-45f1-87a0-9f1cb88cc49e"},"outputs":[{"output_type":"stream","name":"stdout","text":["Hit:1 http://archive.ubuntu.com/ubuntu focal InRelease\n","Get:2 http://archive.ubuntu.com/ubuntu focal-updates InRelease [114 kB]\n","Get:3 https://cloud.r-project.org/bin/linux/ubuntu focal-cran40/ InRelease [3,622 B]\n","Ign:4 https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu2004/x86_64  InRelease\n","Hit:5 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64  InRelease\n","Hit:6 https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu2004/x86_64  Release\n","Get:7 http://ppa.launchpad.net/c2d4u.team/c2d4u4.0+/ubuntu focal InRelease [18.1 kB]\n","Get:8 http://security.ubuntu.com/ubuntu focal-security InRelease [114 kB]\n","Get:9 http://archive.ubuntu.com/ubuntu focal-backports InRelease [108 kB]\n","Hit:10 http://ppa.launchpad.net/cran/libgit2/ubuntu focal InRelease\n","Hit:11 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal InRelease\n","Hit:12 http://ppa.launchpad.net/graphics-drivers/ppa/ubuntu focal InRelease\n","Hit:13 http://ppa.launchpad.net/ubuntugis/ppa/ubuntu focal InRelease\n","Get:15 http://archive.ubuntu.com/ubuntu focal-updates/main amd64 Packages [2,972 kB]\n","Get:16 http://ppa.launchpad.net/c2d4u.team/c2d4u4.0+/ubuntu focal/main Sources [2,393 kB]\n","Get:17 http://security.ubuntu.com/ubuntu focal-security/main amd64 Packages [2,496 kB]\n","Get:18 http://ppa.launchpad.net/c2d4u.team/c2d4u4.0+/ubuntu focal/main amd64 Packages [1,134 kB]\n","Get:19 http://security.ubuntu.com/ubuntu focal-security/universe amd64 Packages [1,006 kB]\n","Get:20 http://archive.ubuntu.com/ubuntu focal-updates/universe amd64 Packages [1,301 kB]\n","Get:21 http://archive.ubuntu.com/ubuntu focal-backports/universe amd64 Packages [28.6 kB]\n","Fetched 11.7 MB in 9s (1,282 kB/s)\n","Reading package lists... Done\n","Building dependency tree       \n","Reading state information... Done\n","30 packages can be upgraded. Run 'apt list --upgradable' to see them.\n","Reading package lists... Done\n","Building dependency tree       \n","Reading state information... Done\n","python3 is already the newest version (3.8.2-0ubuntu2).\n","python3 set to manually installed.\n","The following additional packages will be installed:\n","  python-pip-whl python3-setuptools python3-wheel\n","Suggested packages:\n","  python-setuptools-doc\n","The following NEW packages will be installed:\n","  python-pip-whl python3-pip python3-setuptools python3-wheel\n","0 upgraded, 4 newly installed, 0 to remove and 30 not upgraded.\n","Need to get 2,389 kB of archives.\n","After this operation, 4,933 kB of additional disk space will be used.\n","Get:1 http://archive.ubuntu.com/ubuntu focal-updates/universe amd64 python-pip-whl all 20.0.2-5ubuntu1.7 [1,805 kB]\n","Get:2 http://archive.ubuntu.com/ubuntu focal-updates/main amd64 python3-setuptools all 45.2.0-1ubuntu0.1 [330 kB]\n","Get:3 http://archive.ubuntu.com/ubuntu focal-updates/universe amd64 python3-wheel all 0.34.2-1ubuntu0.1 [23.9 kB]\n","Get:4 http://archive.ubuntu.com/ubuntu focal-updates/universe amd64 python3-pip all 20.0.2-5ubuntu1.7 [230 kB]\n","Fetched 2,389 kB in 0s (6,904 kB/s)\n","debconf: unable to initialize frontend: Dialog\n","debconf: (No usable dialog-like program is installed, so the dialog based frontend cannot be used. at /usr/share/perl5/Debconf/FrontEnd/Dialog.pm line 76, <> line 4.)\n","debconf: falling back to frontend: Readline\n","debconf: unable to initialize frontend: Readline\n","debconf: (This frontend requires a controlling tty.)\n","debconf: falling back to frontend: Teletype\n","dpkg-preconfigure: unable to re-open stdin: \n","Selecting previously unselected package python-pip-whl.\n","(Reading database ... 128208 files and directories currently installed.)\n","Preparing to unpack .../python-pip-whl_20.0.2-5ubuntu1.7_all.deb ...\n","Unpacking python-pip-whl (20.0.2-5ubuntu1.7) ...\n","Selecting previously unselected package python3-setuptools.\n","Preparing to unpack .../python3-setuptools_45.2.0-1ubuntu0.1_all.deb ...\n","Unpacking python3-setuptools (45.2.0-1ubuntu0.1) ...\n","Selecting previously unselected package python3-wheel.\n","Preparing to unpack .../python3-wheel_0.34.2-1ubuntu0.1_all.deb ...\n","Unpacking python3-wheel (0.34.2-1ubuntu0.1) ...\n","Selecting previously unselected package python3-pip.\n","Preparing to unpack .../python3-pip_20.0.2-5ubuntu1.7_all.deb ...\n","Unpacking python3-pip (20.0.2-5ubuntu1.7) ...\n","Setting up python3-setuptools (45.2.0-1ubuntu0.1) ...\n","Setting up python3-wheel (0.34.2-1ubuntu0.1) ...\n","Setting up python-pip-whl (20.0.2-5ubuntu1.7) ...\n","Setting up python3-pip (20.0.2-5ubuntu1.7) ...\n","Processing triggers for man-db (2.9.1-1) ...\n","/bin/bash: !pip3: command not found\n"]}],"source":["!sudo apt update && sudo apt install --yes python3 python3-pip && \\\n","!pip3 install psycopg2-binary"]},{"cell_type":"markdown","metadata":{"id":"5NXIwaSQh9AV"},"source":["Импорт библиотеки"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":3223,"status":"ok","timestamp":1677556937915,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"BieX5A1nh9iR"},"outputs":[],"source":["import psycopg2\n","\n","conn = psycopg2.connect(\"\"\"\n","    host=rc1b-70q90cunwkzx49mj.mdb.yandexcloud.net\n","    port=6432\n","    sslmode=verify-full\n","    dbname=db_clients\n","    user=mlhs_student\n","    password=mlhs_student\n","    target_session_attrs=read-write\n","\"\"\")"]},{"cell_type":"markdown","metadata":{"id":"igbKzmN-iiYR"},"source":["Импорт данных по проекту кредитного скоринга"]},{"cell_type":"code","execution_count":5,"metadata":{"executionInfo":{"elapsed":4540,"status":"ok","timestamp":1677556943849,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"CuFBTym3iqd5"},"outputs":[],"source":["import pandas as pd\n","\n","query = \"SELECT * from public.credit_scoring\"\n","data = pd.read_sql_query(query, conn)\n","\n","conn.close()"]},{"cell_type":"markdown","metadata":{"id":"-T_vFsDgNOIH"},"source":["Целевая - SeriousDlqin2yrs: Клиент имел просрочку 90 и более дней\n","\n","RevolvingUtilizationOfUnsecuredLines: Общий баланс средств (total balance on credit cards and personal lines of credit except real estate and no installment debt like car loans divided by the sum of credit limits).\n","\n","age: Возраст заемщика\n","\n","NumberOfTime30-59DaysPastDueNotWorse: Сколько раз за последние 2 года наблюдалась просрочка 30-59 дней.\n","\n","DebtRatio: Ежемесячные расходы (платеж по долгам, алиментам, расходы на проживания) деленные на месячный доход.\n","\n","MonthlyIncome: Ежемесячный доход.\n","\n","NumberOfOpenCreditLinesAndLoans: Количество открытых кредитов (напрмер, автокредит или ипотека) и кредитных карт.\n","\n","NumberOfTimes90DaysLate: Сколько раз наблюдалась просрочка (90 и более дней).\n","\n","NumberRealEstateLoansOrLines: Количество кредиов (в том числе под залог жилья)\n","\n","NumberOfTime60-89DaysPastDueNotWorse: Сколько раз за последние 2 года заемщик задержал платеж на 60-89 дней.\n","\n","NumberOfDependents: Количество иждивенцев на попечении (супруги, дети и др).\n"]},{"cell_type":"markdown","metadata":{"id":"50ZcvBZNjAUK"},"source":["Проверка полученных данных"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":287},"executionInfo":{"elapsed":11,"status":"ok","timestamp":1677556943850,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"2v75Nza7jEEe","outputId":"88b863d0-c4ed-487f-d7b0-f1ead4faf3c1"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   SeriousDlqin2yrs  RevolvingUtilizationOfUnsecuredLines  age  \\\n","0                 1                              0.766127   45   \n","1                 0                              0.957151   40   \n","2                 0                              0.658180   38   \n","3                 0                              0.233810   30   \n","4                 0                              0.907239   49   \n","\n","   NumberOfTime30-59DaysPastDueNotWorse  DebtRatio  MonthlyIncome  \\\n","0                                     2   0.802982         9120.0   \n","1                                     0   0.121876         2600.0   \n","2                                     1   0.085113         3042.0   \n","3                                     0   0.036050         3300.0   \n","4                                     1   0.024926        63588.0   \n","\n","   NumberOfOpenCreditLinesAndLoans  NumberOfTimes90DaysLate  \\\n","0                               13                        0   \n","1                                4                        0   \n","2                                2                        1   \n","3                                5                        0   \n","4                                7                        0   \n","\n","   NumberRealEstateLoansOrLines  NumberOfTime60-89DaysPastDueNotWorse  \\\n","0                             6                                     0   \n","1                             0                                     0   \n","2                             0                                     0   \n","3                             0                                     0   \n","4                             1                                     0   \n","\n","   NumberOfDependents  \n","0                 2.0  \n","1                 1.0  \n","2                 0.0  \n","3                 0.0  \n","4                 0.0  "],"text/html":["\n","  <div id=\"df-4988f59f-0bd3-4f72-b1e4-86a23ca9b3d1\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>SeriousDlqin2yrs</th>\n","      <th>RevolvingUtilizationOfUnsecuredLines</th>\n","      <th>age</th>\n","      <th>NumberOfTime30-59DaysPastDueNotWorse</th>\n","      <th>DebtRatio</th>\n","      <th>MonthlyIncome</th>\n","      <th>NumberOfOpenCreditLinesAndLoans</th>\n","      <th>NumberOfTimes90DaysLate</th>\n","      <th>NumberRealEstateLoansOrLines</th>\n","      <th>NumberOfTime60-89DaysPastDueNotWorse</th>\n","      <th>NumberOfDependents</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0.766127</td>\n","      <td>45</td>\n","      <td>2</td>\n","      <td>0.802982</td>\n","      <td>9120.0</td>\n","      <td>13</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>0</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>0.957151</td>\n","      <td>40</td>\n","      <td>0</td>\n","      <td>0.121876</td>\n","      <td>2600.0</td>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>0.658180</td>\n","      <td>38</td>\n","      <td>1</td>\n","      <td>0.085113</td>\n","      <td>3042.0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>0.233810</td>\n","      <td>30</td>\n","      <td>0</td>\n","      <td>0.036050</td>\n","      <td>3300.0</td>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>0.907239</td>\n","      <td>49</td>\n","      <td>1</td>\n","      <td>0.024926</td>\n","      <td>63588.0</td>\n","      <td>7</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4988f59f-0bd3-4f72-b1e4-86a23ca9b3d1')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-4988f59f-0bd3-4f72-b1e4-86a23ca9b3d1 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-4988f59f-0bd3-4f72-b1e4-86a23ca9b3d1');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":6}],"source":["data.head()"]},{"cell_type":"markdown","metadata":{"id":"j2o1N_T1ome2"},"source":["Отображена часть данных. Смотрим сколько всего столбцев и строк в data set"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":275,"status":"ok","timestamp":1677556946212,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"diyx15K4o3ah","outputId":"9d9fc563-10f6-4660-c14c-2f27970a12cf"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(150000, 11)"]},"metadata":{},"execution_count":7}],"source":["data.shape"]},{"cell_type":"markdown","metadata":{"id":"5r9wTvIupLl0"},"source":["Проверка дубликатов (полное совпадение по строке) (609 дубликатов)"]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":505},"executionInfo":{"elapsed":12,"status":"ok","timestamp":1677556947816,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"EGvB7EAKpRN9","outputId":"02d4f6a6-7e21-46ce-f8ba-d18f8874051d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["        SeriousDlqin2yrs  RevolvingUtilizationOfUnsecuredLines  age  \\\n","0                      1                              0.766127   45   \n","1                      0                              0.957151   40   \n","2                      0                              0.658180   38   \n","3                      0                              0.233810   30   \n","4                      0                              0.907239   49   \n","...                  ...                                   ...  ...   \n","149995                 0                              0.040674   74   \n","149996                 0                              0.299745   44   \n","149997                 0                              0.246044   58   \n","149998                 0                              0.000000   30   \n","149999                 0                              0.850283   64   \n","\n","        NumberOfTime30-59DaysPastDueNotWorse    DebtRatio  MonthlyIncome  \\\n","0                                          2     0.802982         9120.0   \n","1                                          0     0.121876         2600.0   \n","2                                          1     0.085113         3042.0   \n","3                                          0     0.036050         3300.0   \n","4                                          1     0.024926        63588.0   \n","...                                      ...          ...            ...   \n","149995                                     0     0.225131         2100.0   \n","149996                                     0     0.716562         5584.0   \n","149997                                     0  3870.000000            NaN   \n","149998                                     0     0.000000         5716.0   \n","149999                                     0     0.249908         8158.0   \n","\n","        NumberOfOpenCreditLinesAndLoans  NumberOfTimes90DaysLate  \\\n","0                                    13                        0   \n","1                                     4                        0   \n","2                                     2                        1   \n","3                                     5                        0   \n","4                                     7                        0   \n","...                                 ...                      ...   \n","149995                                4                        0   \n","149996                                4                        0   \n","149997                               18                        0   \n","149998                                4                        0   \n","149999                                8                        0   \n","\n","        NumberRealEstateLoansOrLines  NumberOfTime60-89DaysPastDueNotWorse  \\\n","0                                  6                                     0   \n","1                                  0                                     0   \n","2                                  0                                     0   \n","3                                  0                                     0   \n","4                                  1                                     0   \n","...                              ...                                   ...   \n","149995                             1                                     0   \n","149996                             1                                     0   \n","149997                             1                                     0   \n","149998                             0                                     0   \n","149999                             2                                     0   \n","\n","        NumberOfDependents  \n","0                      2.0  \n","1                      1.0  \n","2                      0.0  \n","3                      0.0  \n","4                      0.0  \n","...                    ...  \n","149995                 0.0  \n","149996                 2.0  \n","149997                 0.0  \n","149998                 0.0  \n","149999                 0.0  \n","\n","[149391 rows x 11 columns]"],"text/html":["\n","  <div id=\"df-55bf1f34-530c-4074-9cd5-cc30247b0879\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>SeriousDlqin2yrs</th>\n","      <th>RevolvingUtilizationOfUnsecuredLines</th>\n","      <th>age</th>\n","      <th>NumberOfTime30-59DaysPastDueNotWorse</th>\n","      <th>DebtRatio</th>\n","      <th>MonthlyIncome</th>\n","      <th>NumberOfOpenCreditLinesAndLoans</th>\n","      <th>NumberOfTimes90DaysLate</th>\n","      <th>NumberRealEstateLoansOrLines</th>\n","      <th>NumberOfTime60-89DaysPastDueNotWorse</th>\n","      <th>NumberOfDependents</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0.766127</td>\n","      <td>45</td>\n","      <td>2</td>\n","      <td>0.802982</td>\n","      <td>9120.0</td>\n","      <td>13</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>0</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>0.957151</td>\n","      <td>40</td>\n","      <td>0</td>\n","      <td>0.121876</td>\n","      <td>2600.0</td>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>0.658180</td>\n","      <td>38</td>\n","      <td>1</td>\n","      <td>0.085113</td>\n","      <td>3042.0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>0.233810</td>\n","      <td>30</td>\n","      <td>0</td>\n","      <td>0.036050</td>\n","      <td>3300.0</td>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>0.907239</td>\n","      <td>49</td>\n","      <td>1</td>\n","      <td>0.024926</td>\n","      <td>63588.0</td>\n","      <td>7</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>149995</th>\n","      <td>0</td>\n","      <td>0.040674</td>\n","      <td>74</td>\n","      <td>0</td>\n","      <td>0.225131</td>\n","      <td>2100.0</td>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>149996</th>\n","      <td>0</td>\n","      <td>0.299745</td>\n","      <td>44</td>\n","      <td>0</td>\n","      <td>0.716562</td>\n","      <td>5584.0</td>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>149997</th>\n","      <td>0</td>\n","      <td>0.246044</td>\n","      <td>58</td>\n","      <td>0</td>\n","      <td>3870.000000</td>\n","      <td>NaN</td>\n","      <td>18</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>149998</th>\n","      <td>0</td>\n","      <td>0.000000</td>\n","      <td>30</td>\n","      <td>0</td>\n","      <td>0.000000</td>\n","      <td>5716.0</td>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>149999</th>\n","      <td>0</td>\n","      <td>0.850283</td>\n","      <td>64</td>\n","      <td>0</td>\n","      <td>0.249908</td>\n","      <td>8158.0</td>\n","      <td>8</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>149391 rows × 11 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-55bf1f34-530c-4074-9cd5-cc30247b0879')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-55bf1f34-530c-4074-9cd5-cc30247b0879 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-55bf1f34-530c-4074-9cd5-cc30247b0879');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}],"source":["data.drop_duplicates()"]},{"cell_type":"markdown","metadata":{"id":"NmWoGosupfJc"},"source":["Проверка пропусков + типы данных (dtype)"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":377,"status":"ok","timestamp":1677556950177,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"h0W--cFrqBgp","outputId":"f948f620-2882-4b81-87cb-196c449aedde"},"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 150000 entries, 0 to 149999\n","Data columns (total 11 columns):\n"," #   Column                                Non-Null Count   Dtype  \n","---  ------                                --------------   -----  \n"," 0   SeriousDlqin2yrs                      150000 non-null  int64  \n"," 1   RevolvingUtilizationOfUnsecuredLines  150000 non-null  float64\n"," 2   age                                   150000 non-null  int64  \n"," 3   NumberOfTime30-59DaysPastDueNotWorse  150000 non-null  int64  \n"," 4   DebtRatio                             150000 non-null  float64\n"," 5   MonthlyIncome                         120269 non-null  float64\n"," 6   NumberOfOpenCreditLinesAndLoans       150000 non-null  int64  \n"," 7   NumberOfTimes90DaysLate               150000 non-null  int64  \n"," 8   NumberRealEstateLoansOrLines          150000 non-null  int64  \n"," 9   NumberOfTime60-89DaysPastDueNotWorse  150000 non-null  int64  \n"," 10  NumberOfDependents                    146076 non-null  float64\n","dtypes: float64(4), int64(7)\n","memory usage: 12.6 MB\n"]}],"source":["data.info()"]},{"cell_type":"markdown","metadata":{"id":"9vWJvflZvPDr"},"source":["Количество пропусков в строках"]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":365,"status":"ok","timestamp":1677556952202,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"gQVswdjZunQD","outputId":"ffe93c97-0a8d-469d-f175-6bd52f74031f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["SeriousDlqin2yrs                            0\n","RevolvingUtilizationOfUnsecuredLines        0\n","age                                         0\n","NumberOfTime30-59DaysPastDueNotWorse        0\n","DebtRatio                                   0\n","MonthlyIncome                           29731\n","NumberOfOpenCreditLinesAndLoans             0\n","NumberOfTimes90DaysLate                     0\n","NumberRealEstateLoansOrLines                0\n","NumberOfTime60-89DaysPastDueNotWorse        0\n","NumberOfDependents                       3924\n","dtype: int64"]},"metadata":{},"execution_count":10}],"source":["data.isna().sum()"]},{"cell_type":"markdown","metadata":{"id":"Zi3_i2v4m5er"},"source":["Посмотрим описание статистик "]},{"cell_type":"code","execution_count":11,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":381},"executionInfo":{"elapsed":431,"status":"ok","timestamp":1677556954776,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"R4c6eHabm8J4","outputId":"bb49823d-3537-4204-85db-2497f0bef471"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["       SeriousDlqin2yrs  RevolvingUtilizationOfUnsecuredLines            age  \\\n","count     150000.000000                         150000.000000  150000.000000   \n","mean           0.066840                              6.048438      52.295207   \n","std            0.249746                            249.755371      14.771866   \n","min            0.000000                              0.000000       0.000000   \n","25%            0.000000                              0.029867      41.000000   \n","50%            0.000000                              0.154181      52.000000   \n","75%            0.000000                              0.559046      63.000000   \n","max            1.000000                          50708.000000     109.000000   \n","\n","       NumberOfTime30-59DaysPastDueNotWorse      DebtRatio  MonthlyIncome  \\\n","count                         150000.000000  150000.000000   1.202690e+05   \n","mean                               0.421033     353.005076   6.670221e+03   \n","std                                4.192781    2037.818523   1.438467e+04   \n","min                                0.000000       0.000000   0.000000e+00   \n","25%                                0.000000       0.175074   3.400000e+03   \n","50%                                0.000000       0.366508   5.400000e+03   \n","75%                                0.000000       0.868254   8.249000e+03   \n","max                               98.000000  329664.000000   3.008750e+06   \n","\n","       NumberOfOpenCreditLinesAndLoans  NumberOfTimes90DaysLate  \\\n","count                    150000.000000            150000.000000   \n","mean                          8.452760                 0.265973   \n","std                           5.145951                 4.169304   \n","min                           0.000000                 0.000000   \n","25%                           5.000000                 0.000000   \n","50%                           8.000000                 0.000000   \n","75%                          11.000000                 0.000000   \n","max                          58.000000                98.000000   \n","\n","       NumberRealEstateLoansOrLines  NumberOfTime60-89DaysPastDueNotWorse  \\\n","count                 150000.000000                         150000.000000   \n","mean                       1.018240                              0.240387   \n","std                        1.129771                              4.155179   \n","min                        0.000000                              0.000000   \n","25%                        0.000000                              0.000000   \n","50%                        1.000000                              0.000000   \n","75%                        2.000000                              0.000000   \n","max                       54.000000                             98.000000   \n","\n","       NumberOfDependents  \n","count       146076.000000  \n","mean             0.757222  \n","std              1.115086  \n","min              0.000000  \n","25%              0.000000  \n","50%              0.000000  \n","75%              1.000000  \n","max             20.000000  "],"text/html":["\n","  <div id=\"df-96e0af9e-2e9a-4b5b-9cdd-429d205d1592\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>SeriousDlqin2yrs</th>\n","      <th>RevolvingUtilizationOfUnsecuredLines</th>\n","      <th>age</th>\n","      <th>NumberOfTime30-59DaysPastDueNotWorse</th>\n","      <th>DebtRatio</th>\n","      <th>MonthlyIncome</th>\n","      <th>NumberOfOpenCreditLinesAndLoans</th>\n","      <th>NumberOfTimes90DaysLate</th>\n","      <th>NumberRealEstateLoansOrLines</th>\n","      <th>NumberOfTime60-89DaysPastDueNotWorse</th>\n","      <th>NumberOfDependents</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>count</th>\n","      <td>150000.000000</td>\n","      <td>150000.000000</td>\n","      <td>150000.000000</td>\n","      <td>150000.000000</td>\n","      <td>150000.000000</td>\n","      <td>1.202690e+05</td>\n","      <td>150000.000000</td>\n","      <td>150000.000000</td>\n","      <td>150000.000000</td>\n","      <td>150000.000000</td>\n","      <td>146076.000000</td>\n","    </tr>\n","    <tr>\n","      <th>mean</th>\n","      <td>0.066840</td>\n","      <td>6.048438</td>\n","      <td>52.295207</td>\n","      <td>0.421033</td>\n","      <td>353.005076</td>\n","      <td>6.670221e+03</td>\n","      <td>8.452760</td>\n","      <td>0.265973</td>\n","      <td>1.018240</td>\n","      <td>0.240387</td>\n","      <td>0.757222</td>\n","    </tr>\n","    <tr>\n","      <th>std</th>\n","      <td>0.249746</td>\n","      <td>249.755371</td>\n","      <td>14.771866</td>\n","      <td>4.192781</td>\n","      <td>2037.818523</td>\n","      <td>1.438467e+04</td>\n","      <td>5.145951</td>\n","      <td>4.169304</td>\n","      <td>1.129771</td>\n","      <td>4.155179</td>\n","      <td>1.115086</td>\n","    </tr>\n","    <tr>\n","      <th>min</th>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000e+00</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>25%</th>\n","      <td>0.000000</td>\n","      <td>0.029867</td>\n","      <td>41.000000</td>\n","      <td>0.000000</td>\n","      <td>0.175074</td>\n","      <td>3.400000e+03</td>\n","      <td>5.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>50%</th>\n","      <td>0.000000</td>\n","      <td>0.154181</td>\n","      <td>52.000000</td>\n","      <td>0.000000</td>\n","      <td>0.366508</td>\n","      <td>5.400000e+03</td>\n","      <td>8.000000</td>\n","      <td>0.000000</td>\n","      <td>1.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>75%</th>\n","      <td>0.000000</td>\n","      <td>0.559046</td>\n","      <td>63.000000</td>\n","      <td>0.000000</td>\n","      <td>0.868254</td>\n","      <td>8.249000e+03</td>\n","      <td>11.000000</td>\n","      <td>0.000000</td>\n","      <td>2.000000</td>\n","      <td>0.000000</td>\n","      <td>1.000000</td>\n","    </tr>\n","    <tr>\n","      <th>max</th>\n","      <td>1.000000</td>\n","      <td>50708.000000</td>\n","      <td>109.000000</td>\n","      <td>98.000000</td>\n","      <td>329664.000000</td>\n","      <td>3.008750e+06</td>\n","      <td>58.000000</td>\n","      <td>98.000000</td>\n","      <td>54.000000</td>\n","      <td>98.000000</td>\n","      <td>20.000000</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-96e0af9e-2e9a-4b5b-9cdd-429d205d1592')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-96e0af9e-2e9a-4b5b-9cdd-429d205d1592 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-96e0af9e-2e9a-4b5b-9cdd-429d205d1592');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":11}],"source":["data.describe ()"]},{"cell_type":"markdown","metadata":{"id":"WuUZQSkYnMQu"},"source":["Построим матрицу корреляции"]},{"cell_type":"code","execution_count":12,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":466},"executionInfo":{"elapsed":406,"status":"ok","timestamp":1677556957526,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"Cdxb1hisnPQN","outputId":"7fff767d-b49d-4d7e-e5d8-67dc9eb41386"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["<pandas.io.formats.style.Styler at 0x7f49774d8610>"],"text/html":["<style type=\"text/css\">\n","#T_f1c8d_row0_col0, #T_f1c8d_row1_col1, #T_f1c8d_row2_col2, #T_f1c8d_row3_col3, #T_f1c8d_row4_col4, #T_f1c8d_row5_col5, #T_f1c8d_row6_col6, #T_f1c8d_row7_col7, #T_f1c8d_row8_col8, #T_f1c8d_row9_col9, #T_f1c8d_row10_col10 {\n","  background-color: #b40426;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row0_col1, #T_f1c8d_row0_col5, #T_f1c8d_row3_col1, #T_f1c8d_row5_col4, #T_f1c8d_row7_col1, #T_f1c8d_row9_col1, #T_f1c8d_row9_col6 {\n","  background-color: #3d50c3;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row0_col2 {\n","  background-color: #536edd;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row0_col3, #T_f1c8d_row1_col10 {\n","  background-color: #7396f5;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row0_col4, #T_f1c8d_row1_col5, #T_f1c8d_row3_col4, #T_f1c8d_row8_col7, #T_f1c8d_row9_col4 {\n","  background-color: #445acc;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row0_col6 {\n","  background-color: #485fd1;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row0_col7 {\n","  background-color: #7597f6;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row0_col8 {\n","  background-color: #455cce;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row0_col9, #T_f1c8d_row5_col8, #T_f1c8d_row10_col8 {\n","  background-color: #6e90f2;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row0_col10 {\n","  background-color: #80a3fa;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row1_col0 {\n","  background-color: #5a78e4;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row1_col2 {\n","  background-color: #7093f3;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row1_col3, #T_f1c8d_row5_col9, #T_f1c8d_row10_col3, #T_f1c8d_row10_col9 {\n","  background-color: #4b64d5;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row1_col4 {\n","  background-color: #465ecf;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row1_col6, #T_f1c8d_row1_col9, #T_f1c8d_row2_col5, #T_f1c8d_row4_col7, #T_f1c8d_row10_col7 {\n","  background-color: #4e68d8;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row1_col7 {\n","  background-color: #506bda;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row1_col8, #T_f1c8d_row5_col3 {\n","  background-color: #4961d2;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row2_col0, #T_f1c8d_row2_col3, #T_f1c8d_row2_col10, #T_f1c8d_row4_col5, #T_f1c8d_row6_col1, #T_f1c8d_row6_col7, #T_f1c8d_row6_col9, #T_f1c8d_row7_col6, #T_f1c8d_row7_col8, #T_f1c8d_row10_col2, #T_f1c8d_row10_col4 {\n","  background-color: #3b4cc0;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row2_col1, #T_f1c8d_row6_col3, #T_f1c8d_row9_col8 {\n","  background-color: #3c4ec2;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row2_col4, #T_f1c8d_row4_col9, #T_f1c8d_row5_col7 {\n","  background-color: #4c66d6;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row2_col6, #T_f1c8d_row7_col0 {\n","  background-color: #7ea1fa;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row2_col7, #T_f1c8d_row3_col5, #T_f1c8d_row5_col1, #T_f1c8d_row8_col1, #T_f1c8d_row9_col5 {\n","  background-color: #3f53c6;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row2_col8, #T_f1c8d_row6_col0 {\n","  background-color: #516ddb;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row2_col9, #T_f1c8d_row3_col8, #T_f1c8d_row4_col1, #T_f1c8d_row7_col5, #T_f1c8d_row10_col1 {\n","  background-color: #3e51c5;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row3_col0 {\n","  background-color: #81a4fb;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row3_col2 {\n","  background-color: #6180e9;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row3_col6 {\n","  background-color: #4055c8;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row3_col7, #T_f1c8d_row3_col9, #T_f1c8d_row7_col3, #T_f1c8d_row9_col3 {\n","  background-color: #b8122a;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row3_col10 {\n","  background-color: #7295f4;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row4_col0, #T_f1c8d_row8_col0 {\n","  background-color: #5875e1;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row4_col2 {\n","  background-color: #7a9df8;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row4_col3 {\n","  background-color: #4a63d3;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row4_col6 {\n","  background-color: #5f7fe8;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row4_col8, #T_f1c8d_row5_col6 {\n","  background-color: #6c8ff1;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row4_col10 {\n","  background-color: #6788ee;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row5_col0 {\n","  background-color: #5470de;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row5_col2, #T_f1c8d_row8_col2 {\n","  background-color: #7da0f9;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row5_col10, #T_f1c8d_row6_col10 {\n","  background-color: #85a8fc;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row6_col2 {\n","  background-color: #9ebeff;\n","  color: #000000;\n","}\n","#T_f1c8d_row6_col4, #T_f1c8d_row10_col5 {\n","  background-color: #5572df;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row6_col5 {\n","  background-color: #5e7de7;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row6_col8 {\n","  background-color: #d2dbe8;\n","  color: #000000;\n","}\n","#T_f1c8d_row7_col2, #T_f1c8d_row9_col2 {\n","  background-color: #6282ea;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row7_col4, #T_f1c8d_row8_col3, #T_f1c8d_row8_col9 {\n","  background-color: #4358cb;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row7_col9, #T_f1c8d_row9_col7 {\n","  background-color: #b50927;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row7_col10, #T_f1c8d_row9_col10 {\n","  background-color: #6f92f3;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row8_col4 {\n","  background-color: #6b8df0;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row8_col5 {\n","  background-color: #6a8bef;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row8_col6 {\n","  background-color: #d6dce4;\n","  color: #000000;\n","}\n","#T_f1c8d_row8_col10 {\n","  background-color: #97b8ff;\n","  color: #000000;\n","}\n","#T_f1c8d_row9_col0 {\n","  background-color: #799cf8;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row10_col0 {\n","  background-color: #688aef;\n","  color: #f1f1f1;\n","}\n","#T_f1c8d_row10_col6 {\n","  background-color: #6485ec;\n","  color: #f1f1f1;\n","}\n","</style>\n","<table id=\"T_f1c8d_\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th class=\"blank level0\" >&nbsp;</th>\n","      <th class=\"col_heading level0 col0\" >SeriousDlqin2yrs</th>\n","      <th class=\"col_heading level0 col1\" >RevolvingUtilizationOfUnsecuredLines</th>\n","      <th class=\"col_heading level0 col2\" >age</th>\n","      <th class=\"col_heading level0 col3\" >NumberOfTime30-59DaysPastDueNotWorse</th>\n","      <th class=\"col_heading level0 col4\" >DebtRatio</th>\n","      <th class=\"col_heading level0 col5\" >MonthlyIncome</th>\n","      <th class=\"col_heading level0 col6\" >NumberOfOpenCreditLinesAndLoans</th>\n","      <th class=\"col_heading level0 col7\" >NumberOfTimes90DaysLate</th>\n","      <th class=\"col_heading level0 col8\" >NumberRealEstateLoansOrLines</th>\n","      <th class=\"col_heading level0 col9\" >NumberOfTime60-89DaysPastDueNotWorse</th>\n","      <th class=\"col_heading level0 col10\" >NumberOfDependents</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th id=\"T_f1c8d_level0_row0\" class=\"row_heading level0 row0\" >SeriousDlqin2yrs</th>\n","      <td id=\"T_f1c8d_row0_col0\" class=\"data row0 col0\" >1.000000</td>\n","      <td id=\"T_f1c8d_row0_col1\" class=\"data row0 col1\" >-0.001802</td>\n","      <td id=\"T_f1c8d_row0_col2\" class=\"data row0 col2\" >-0.115386</td>\n","      <td id=\"T_f1c8d_row0_col3\" class=\"data row0 col3\" >0.125587</td>\n","      <td id=\"T_f1c8d_row0_col4\" class=\"data row0 col4\" >-0.007602</td>\n","      <td id=\"T_f1c8d_row0_col5\" class=\"data row0 col5\" >-0.019746</td>\n","      <td id=\"T_f1c8d_row0_col6\" class=\"data row0 col6\" >-0.029669</td>\n","      <td id=\"T_f1c8d_row0_col7\" class=\"data row0 col7\" >0.117175</td>\n","      <td id=\"T_f1c8d_row0_col8\" class=\"data row0 col8\" >-0.007038</td>\n","      <td id=\"T_f1c8d_row0_col9\" class=\"data row0 col9\" >0.102261</td>\n","      <td id=\"T_f1c8d_row0_col10\" class=\"data row0 col10\" >0.046048</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f1c8d_level0_row1\" class=\"row_heading level0 row1\" >RevolvingUtilizationOfUnsecuredLines</th>\n","      <td id=\"T_f1c8d_row1_col0\" class=\"data row1 col0\" >-0.001802</td>\n","      <td id=\"T_f1c8d_row1_col1\" class=\"data row1 col1\" >1.000000</td>\n","      <td id=\"T_f1c8d_row1_col2\" class=\"data row1 col2\" >-0.005898</td>\n","      <td id=\"T_f1c8d_row1_col3\" class=\"data row1 col3\" >-0.001314</td>\n","      <td id=\"T_f1c8d_row1_col4\" class=\"data row1 col4\" >0.003961</td>\n","      <td id=\"T_f1c8d_row1_col5\" class=\"data row1 col5\" >0.007124</td>\n","      <td id=\"T_f1c8d_row1_col6\" class=\"data row1 col6\" >-0.011281</td>\n","      <td id=\"T_f1c8d_row1_col7\" class=\"data row1 col7\" >-0.001061</td>\n","      <td id=\"T_f1c8d_row1_col8\" class=\"data row1 col8\" >0.006235</td>\n","      <td id=\"T_f1c8d_row1_col9\" class=\"data row1 col9\" >-0.001048</td>\n","      <td id=\"T_f1c8d_row1_col10\" class=\"data row1 col10\" >0.001557</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f1c8d_level0_row2\" class=\"row_heading level0 row2\" >age</th>\n","      <td id=\"T_f1c8d_row2_col0\" class=\"data row2 col0\" >-0.115386</td>\n","      <td id=\"T_f1c8d_row2_col1\" class=\"data row2 col1\" >-0.005898</td>\n","      <td id=\"T_f1c8d_row2_col2\" class=\"data row2 col2\" >1.000000</td>\n","      <td id=\"T_f1c8d_row2_col3\" class=\"data row2 col3\" >-0.062995</td>\n","      <td id=\"T_f1c8d_row2_col4\" class=\"data row2 col4\" >0.024188</td>\n","      <td id=\"T_f1c8d_row2_col5\" class=\"data row2 col5\" >0.037717</td>\n","      <td id=\"T_f1c8d_row2_col6\" class=\"data row2 col6\" >0.147705</td>\n","      <td id=\"T_f1c8d_row2_col7\" class=\"data row2 col7\" >-0.061005</td>\n","      <td id=\"T_f1c8d_row2_col8\" class=\"data row2 col8\" >0.033150</td>\n","      <td id=\"T_f1c8d_row2_col9\" class=\"data row2 col9\" >-0.057159</td>\n","      <td id=\"T_f1c8d_row2_col10\" class=\"data row2 col10\" >-0.213303</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f1c8d_level0_row3\" class=\"row_heading level0 row3\" >NumberOfTime30-59DaysPastDueNotWorse</th>\n","      <td id=\"T_f1c8d_row3_col0\" class=\"data row3 col0\" >0.125587</td>\n","      <td id=\"T_f1c8d_row3_col1\" class=\"data row3 col1\" >-0.001314</td>\n","      <td id=\"T_f1c8d_row3_col2\" class=\"data row3 col2\" >-0.062995</td>\n","      <td id=\"T_f1c8d_row3_col3\" class=\"data row3 col3\" >1.000000</td>\n","      <td id=\"T_f1c8d_row3_col4\" class=\"data row3 col4\" >-0.006542</td>\n","      <td id=\"T_f1c8d_row3_col5\" class=\"data row3 col5\" >-0.010217</td>\n","      <td id=\"T_f1c8d_row3_col6\" class=\"data row3 col6\" >-0.055312</td>\n","      <td id=\"T_f1c8d_row3_col7\" class=\"data row3 col7\" >0.983603</td>\n","      <td id=\"T_f1c8d_row3_col8\" class=\"data row3 col8\" >-0.030565</td>\n","      <td id=\"T_f1c8d_row3_col9\" class=\"data row3 col9\" >0.987005</td>\n","      <td id=\"T_f1c8d_row3_col10\" class=\"data row3 col10\" >-0.002680</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f1c8d_level0_row4\" class=\"row_heading level0 row4\" >DebtRatio</th>\n","      <td id=\"T_f1c8d_row4_col0\" class=\"data row4 col0\" >-0.007602</td>\n","      <td id=\"T_f1c8d_row4_col1\" class=\"data row4 col1\" >0.003961</td>\n","      <td id=\"T_f1c8d_row4_col2\" class=\"data row4 col2\" >0.024188</td>\n","      <td id=\"T_f1c8d_row4_col3\" class=\"data row4 col3\" >-0.006542</td>\n","      <td id=\"T_f1c8d_row4_col4\" class=\"data row4 col4\" >1.000000</td>\n","      <td id=\"T_f1c8d_row4_col5\" class=\"data row4 col5\" >-0.028712</td>\n","      <td id=\"T_f1c8d_row4_col6\" class=\"data row4 col6\" >0.049565</td>\n","      <td id=\"T_f1c8d_row4_col7\" class=\"data row4 col7\" >-0.008320</td>\n","      <td id=\"T_f1c8d_row4_col8\" class=\"data row4 col8\" >0.120046</td>\n","      <td id=\"T_f1c8d_row4_col9\" class=\"data row4 col9\" >-0.007533</td>\n","      <td id=\"T_f1c8d_row4_col10\" class=\"data row4 col10\" >-0.040673</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f1c8d_level0_row5\" class=\"row_heading level0 row5\" >MonthlyIncome</th>\n","      <td id=\"T_f1c8d_row5_col0\" class=\"data row5 col0\" >-0.019746</td>\n","      <td id=\"T_f1c8d_row5_col1\" class=\"data row5 col1\" >0.007124</td>\n","      <td id=\"T_f1c8d_row5_col2\" class=\"data row5 col2\" >0.037717</td>\n","      <td id=\"T_f1c8d_row5_col3\" class=\"data row5 col3\" >-0.010217</td>\n","      <td id=\"T_f1c8d_row5_col4\" class=\"data row5 col4\" >-0.028712</td>\n","      <td id=\"T_f1c8d_row5_col5\" class=\"data row5 col5\" >1.000000</td>\n","      <td id=\"T_f1c8d_row5_col6\" class=\"data row5 col6\" >0.091455</td>\n","      <td id=\"T_f1c8d_row5_col7\" class=\"data row5 col7\" >-0.012743</td>\n","      <td id=\"T_f1c8d_row5_col8\" class=\"data row5 col8\" >0.124959</td>\n","      <td id=\"T_f1c8d_row5_col9\" class=\"data row5 col9\" >-0.011116</td>\n","      <td id=\"T_f1c8d_row5_col10\" class=\"data row5 col10\" >0.062647</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f1c8d_level0_row6\" class=\"row_heading level0 row6\" >NumberOfOpenCreditLinesAndLoans</th>\n","      <td id=\"T_f1c8d_row6_col0\" class=\"data row6 col0\" >-0.029669</td>\n","      <td id=\"T_f1c8d_row6_col1\" class=\"data row6 col1\" >-0.011281</td>\n","      <td id=\"T_f1c8d_row6_col2\" class=\"data row6 col2\" >0.147705</td>\n","      <td id=\"T_f1c8d_row6_col3\" class=\"data row6 col3\" >-0.055312</td>\n","      <td id=\"T_f1c8d_row6_col4\" class=\"data row6 col4\" >0.049565</td>\n","      <td id=\"T_f1c8d_row6_col5\" class=\"data row6 col5\" >0.091455</td>\n","      <td id=\"T_f1c8d_row6_col6\" class=\"data row6 col6\" >1.000000</td>\n","      <td id=\"T_f1c8d_row6_col7\" class=\"data row6 col7\" >-0.079984</td>\n","      <td id=\"T_f1c8d_row6_col8\" class=\"data row6 col8\" >0.433959</td>\n","      <td id=\"T_f1c8d_row6_col9\" class=\"data row6 col9\" >-0.071077</td>\n","      <td id=\"T_f1c8d_row6_col10\" class=\"data row6 col10\" >0.065322</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f1c8d_level0_row7\" class=\"row_heading level0 row7\" >NumberOfTimes90DaysLate</th>\n","      <td id=\"T_f1c8d_row7_col0\" class=\"data row7 col0\" >0.117175</td>\n","      <td id=\"T_f1c8d_row7_col1\" class=\"data row7 col1\" >-0.001061</td>\n","      <td id=\"T_f1c8d_row7_col2\" class=\"data row7 col2\" >-0.061005</td>\n","      <td id=\"T_f1c8d_row7_col3\" class=\"data row7 col3\" >0.983603</td>\n","      <td id=\"T_f1c8d_row7_col4\" class=\"data row7 col4\" >-0.008320</td>\n","      <td id=\"T_f1c8d_row7_col5\" class=\"data row7 col5\" >-0.012743</td>\n","      <td id=\"T_f1c8d_row7_col6\" class=\"data row7 col6\" >-0.079984</td>\n","      <td id=\"T_f1c8d_row7_col7\" class=\"data row7 col7\" >1.000000</td>\n","      <td id=\"T_f1c8d_row7_col8\" class=\"data row7 col8\" >-0.045205</td>\n","      <td id=\"T_f1c8d_row7_col9\" class=\"data row7 col9\" >0.992796</td>\n","      <td id=\"T_f1c8d_row7_col10\" class=\"data row7 col10\" >-0.010176</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f1c8d_level0_row8\" class=\"row_heading level0 row8\" >NumberRealEstateLoansOrLines</th>\n","      <td id=\"T_f1c8d_row8_col0\" class=\"data row8 col0\" >-0.007038</td>\n","      <td id=\"T_f1c8d_row8_col1\" class=\"data row8 col1\" >0.006235</td>\n","      <td id=\"T_f1c8d_row8_col2\" class=\"data row8 col2\" >0.033150</td>\n","      <td id=\"T_f1c8d_row8_col3\" class=\"data row8 col3\" >-0.030565</td>\n","      <td id=\"T_f1c8d_row8_col4\" class=\"data row8 col4\" >0.120046</td>\n","      <td id=\"T_f1c8d_row8_col5\" class=\"data row8 col5\" >0.124959</td>\n","      <td id=\"T_f1c8d_row8_col6\" class=\"data row8 col6\" >0.433959</td>\n","      <td id=\"T_f1c8d_row8_col7\" class=\"data row8 col7\" >-0.045205</td>\n","      <td id=\"T_f1c8d_row8_col8\" class=\"data row8 col8\" >1.000000</td>\n","      <td id=\"T_f1c8d_row8_col9\" class=\"data row8 col9\" >-0.039722</td>\n","      <td id=\"T_f1c8d_row8_col10\" class=\"data row8 col10\" >0.124684</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f1c8d_level0_row9\" class=\"row_heading level0 row9\" >NumberOfTime60-89DaysPastDueNotWorse</th>\n","      <td id=\"T_f1c8d_row9_col0\" class=\"data row9 col0\" >0.102261</td>\n","      <td id=\"T_f1c8d_row9_col1\" class=\"data row9 col1\" >-0.001048</td>\n","      <td id=\"T_f1c8d_row9_col2\" class=\"data row9 col2\" >-0.057159</td>\n","      <td id=\"T_f1c8d_row9_col3\" class=\"data row9 col3\" >0.987005</td>\n","      <td id=\"T_f1c8d_row9_col4\" class=\"data row9 col4\" >-0.007533</td>\n","      <td id=\"T_f1c8d_row9_col5\" class=\"data row9 col5\" >-0.011116</td>\n","      <td id=\"T_f1c8d_row9_col6\" class=\"data row9 col6\" >-0.071077</td>\n","      <td id=\"T_f1c8d_row9_col7\" class=\"data row9 col7\" >0.992796</td>\n","      <td id=\"T_f1c8d_row9_col8\" class=\"data row9 col8\" >-0.039722</td>\n","      <td id=\"T_f1c8d_row9_col9\" class=\"data row9 col9\" >1.000000</td>\n","      <td id=\"T_f1c8d_row9_col10\" class=\"data row9 col10\" >-0.010922</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f1c8d_level0_row10\" class=\"row_heading level0 row10\" >NumberOfDependents</th>\n","      <td id=\"T_f1c8d_row10_col0\" class=\"data row10 col0\" >0.046048</td>\n","      <td id=\"T_f1c8d_row10_col1\" class=\"data row10 col1\" >0.001557</td>\n","      <td id=\"T_f1c8d_row10_col2\" class=\"data row10 col2\" >-0.213303</td>\n","      <td id=\"T_f1c8d_row10_col3\" class=\"data row10 col3\" >-0.002680</td>\n","      <td id=\"T_f1c8d_row10_col4\" class=\"data row10 col4\" >-0.040673</td>\n","      <td id=\"T_f1c8d_row10_col5\" class=\"data row10 col5\" >0.062647</td>\n","      <td id=\"T_f1c8d_row10_col6\" class=\"data row10 col6\" >0.065322</td>\n","      <td id=\"T_f1c8d_row10_col7\" class=\"data row10 col7\" >-0.010176</td>\n","      <td id=\"T_f1c8d_row10_col8\" class=\"data row10 col8\" >0.124684</td>\n","      <td id=\"T_f1c8d_row10_col9\" class=\"data row10 col9\" >-0.010922</td>\n","      <td id=\"T_f1c8d_row10_col10\" class=\"data row10 col10\" >1.000000</td>\n","    </tr>\n","  </tbody>\n","</table>\n"]},"metadata":{},"execution_count":12}],"source":["corr = data.corr()\n","corr.style.background_gradient(cmap='coolwarm')"]},{"cell_type":"markdown","metadata":{"id":"BXYewyQPnaCp"},"source":["***2.Оценка качества и очистка ***"]},{"cell_type":"markdown","metadata":{"id":"Ubb1C-uDouKv"},"source":["Присваиваем результат по дублям в исходный обьект"]},{"cell_type":"code","execution_count":13,"metadata":{"executionInfo":{"elapsed":505,"status":"ok","timestamp":1677556961545,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"hL7iRCFkpBpp"},"outputs":[],"source":["data = data.drop_duplicates()"]},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":459,"status":"ok","timestamp":1677556964005,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"qc3bNxzepDW5","outputId":"f4bc414c-84b4-49b4-b19b-3356ead60a35"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(149391, 11)"]},"metadata":{},"execution_count":14}],"source":["data.shape"]},{"cell_type":"markdown","metadata":{"id":"tXkK0NmUq3er"},"source":["Избавляемся от пропусков"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":354,"status":"ok","timestamp":1677556970169,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"p1BUxZyrsZxp","outputId":"d968a77f-69ec-487f-b6d4-f7dd0d4f2de0"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["5000.0     2757\n","4000.0     2106\n","6000.0     1934\n","3000.0     1758\n","0.0        1616\n","           ... \n","16084.0       1\n","10523.0       1\n","55250.0       1\n","9242.0        1\n","7647.0        1\n","Name: MonthlyIncome, Length: 13594, dtype: int64"]},"metadata":{},"execution_count":15}],"source":["data.MonthlyIncome.value_counts()"]},{"cell_type":"code","execution_count":16,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11,"status":"ok","timestamp":1677556972624,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"oDW74ZCrso2P","outputId":"d01d4f79-bc91-4058-a95f-bfce1d68c444"},"outputs":[{"output_type":"stream","name":"stdout","text":["5400.0\n"]}],"source":["median = data['MonthlyIncome'].median()\n","print(median)\n","data['MonthlyIncome'].fillna(median, inplace=True)"]},{"cell_type":"code","execution_count":17,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":816,"status":"ok","timestamp":1677556975296,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"usQM7nuYrNLh","outputId":"b5e97b11-63f8-496a-8269-799c3b45c6bc"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["SeriousDlqin2yrs                           0\n","RevolvingUtilizationOfUnsecuredLines       0\n","age                                        0\n","NumberOfTime30-59DaysPastDueNotWorse       0\n","DebtRatio                                  0\n","MonthlyIncome                              0\n","NumberOfOpenCreditLinesAndLoans            0\n","NumberOfTimes90DaysLate                    0\n","NumberRealEstateLoansOrLines               0\n","NumberOfTime60-89DaysPastDueNotWorse       0\n","NumberOfDependents                      3828\n","dtype: int64"]},"metadata":{},"execution_count":17}],"source":["data.isna().sum()"]},{"cell_type":"code","execution_count":18,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1677556976744,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"vWT2Cb5v5i6X","outputId":"2ffa0ac4-6d90-488a-eb6e-a26dd0c6ecf6"},"outputs":[{"output_type":"stream","name":"stdout","text":["0.0\n"]}],"source":["median = data['NumberOfDependents'].median()\n","print(median)\n","data['NumberOfDependents'].fillna(median, inplace=True)"]},{"cell_type":"markdown","metadata":{"id":"XDN9TF236GUi"},"source":["Проверим пропуски снова"]},{"cell_type":"code","execution_count":19,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":277,"status":"ok","timestamp":1677556980035,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"oxrcjKSp1kn_","outputId":"b9f058c4-8ff3-431f-853e-81470bb59d47"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["SeriousDlqin2yrs                        0\n","RevolvingUtilizationOfUnsecuredLines    0\n","age                                     0\n","NumberOfTime30-59DaysPastDueNotWorse    0\n","DebtRatio                               0\n","MonthlyIncome                           0\n","NumberOfOpenCreditLinesAndLoans         0\n","NumberOfTimes90DaysLate                 0\n","NumberRealEstateLoansOrLines            0\n","NumberOfTime60-89DaysPastDueNotWorse    0\n","NumberOfDependents                      0\n","dtype: int64"]},"metadata":{},"execution_count":19}],"source":["data.isna().sum()"]},{"cell_type":"markdown","metadata":{"id":"srdz0Yuy67Mo"},"source":["Провери сколько различных значений в столбцах"]},{"cell_type":"code","execution_count":20,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9,"status":"ok","timestamp":1677556982802,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"wu-ZeRaD7H99","outputId":"8d35fa5a-c465-4789-c734-21a16eeecab1"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["5400.0     29552\n","5000.0      2757\n","4000.0      2106\n","6000.0      1934\n","3000.0      1758\n","           ...  \n","16084.0        1\n","10523.0        1\n","55250.0        1\n","9242.0         1\n","7647.0         1\n","Name: MonthlyIncome, Length: 13594, dtype: int64"]},"metadata":{},"execution_count":20}],"source":["data.MonthlyIncome.value_counts()"]},{"cell_type":"code","execution_count":21,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":289,"status":"ok","timestamp":1677556985455,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"jlSNpStn7tol","outputId":"7c70a53a-6a3e-4fbf-a759-1e3cf78a4b2a"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.0     90220\n","1.0     26314\n","2.0     19521\n","3.0      9483\n","4.0      2862\n","5.0       746\n","6.0       158\n","7.0        51\n","8.0        24\n","10.0        5\n","9.0         5\n","20.0        1\n","13.0        1\n","Name: NumberOfDependents, dtype: int64"]},"metadata":{},"execution_count":21}],"source":["data.NumberOfDependents.value_counts()"]},{"cell_type":"markdown","metadata":{"id":"Ss9A2BZV_86k"},"source":["Посмотрим на данные моей целевой переменной "]},{"cell_type":"code","execution_count":22,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":373,"status":"ok","timestamp":1677556987911,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"5KDXHqQfAE1D","outputId":"3e5e0fe5-3445-4497-8b84-b6ae2114486f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    139382\n","1     10009\n","Name: SeriousDlqin2yrs, dtype: int64"]},"metadata":{},"execution_count":22}],"source":[" data.SeriousDlqin2yrs. value_counts()"]},{"cell_type":"markdown","metadata":{"id":"bLcsusBEArN6"},"source":["10009 имеют просрочку в 90 дней."]},{"cell_type":"code","execution_count":23,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1677556989526,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"LpNHRqz2A8Hf","outputId":"8204f833-14ee-491b-8fa4-747dcd6e5c42"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0     141108\n","1       5232\n","2       1555\n","3        667\n","4        291\n","98       220\n","5        131\n","6         80\n","7         38\n","8         21\n","9         19\n","10         8\n","96         5\n","11         5\n","13         4\n","15         2\n","14         2\n","12         2\n","17         1\n","Name: NumberOfTimes90DaysLate, dtype: int64"]},"metadata":{},"execution_count":23}],"source":[" data.NumberOfTimes90DaysLate. value_counts()"]},{"cell_type":"markdown","metadata":{"id":"UZX4nNK7vUdE"},"source":["Удаляем данные из линейной зависимости"]},{"cell_type":"code","execution_count":24,"metadata":{"executionInfo":{"elapsed":444,"status":"ok","timestamp":1677556992594,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"Qf1QxqsgVV5i"},"outputs":[],"source":["data = data.drop(['NumberRealEstateLoansOrLines','NumberOfOpenCreditLinesAndLoans'],axis=1)"]},{"cell_type":"code","execution_count":25,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":403},"executionInfo":{"elapsed":314,"status":"ok","timestamp":1677556994344,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"nkXXtAxxZlrb","outputId":"15b08f96-70d5-4e34-fa43-b0fd6095fd48"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["<pandas.io.formats.style.Styler at 0x7f4979acf220>"],"text/html":["<style type=\"text/css\">\n","#T_f0766_row0_col0, #T_f0766_row1_col1, #T_f0766_row2_col2, #T_f0766_row3_col3, #T_f0766_row4_col4, #T_f0766_row5_col5, #T_f0766_row6_col6, #T_f0766_row7_col7, #T_f0766_row8_col8 {\n","  background-color: #b40426;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row0_col1, #T_f0766_row3_col1, #T_f0766_row6_col1, #T_f0766_row6_col5, #T_f0766_row7_col1, #T_f0766_row8_col1 {\n","  background-color: #3c4ec2;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row0_col2, #T_f0766_row8_col5 {\n","  background-color: #5470de;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row0_col3, #T_f0766_row1_col8, #T_f0766_row3_col8 {\n","  background-color: #7396f5;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row0_col4, #T_f0766_row3_col4, #T_f0766_row5_col7, #T_f0766_row6_col4, #T_f0766_row7_col4, #T_f0766_row8_col7 {\n","  background-color: #455cce;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row0_col5, #T_f0766_row2_col0, #T_f0766_row2_col1, #T_f0766_row2_col3, #T_f0766_row2_col6, #T_f0766_row2_col7, #T_f0766_row2_col8, #T_f0766_row4_col5, #T_f0766_row8_col2, #T_f0766_row8_col4 {\n","  background-color: #3b4cc0;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row0_col6 {\n","  background-color: #6f92f3;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row0_col7, #T_f0766_row8_col0 {\n","  background-color: #688aef;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row0_col8 {\n","  background-color: #81a4fb;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row1_col0 {\n","  background-color: #5a78e4;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row1_col2, #T_f0766_row6_col8 {\n","  background-color: #7295f4;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row1_col3, #T_f0766_row8_col3 {\n","  background-color: #4a63d3;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row1_col4, #T_f0766_row1_col7, #T_f0766_row2_col5, #T_f0766_row4_col3, #T_f0766_row5_col3 {\n","  background-color: #485fd1;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row1_col5, #T_f0766_row5_col4 {\n","  background-color: #4257c9;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row1_col6 {\n","  background-color: #4961d2;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row2_col4 {\n","  background-color: #4e68d8;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row3_col0 {\n","  background-color: #82a6fb;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row3_col2, #T_f0766_row6_col2 {\n","  background-color: #6485ec;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row3_col5, #T_f0766_row4_col1, #T_f0766_row7_col5 {\n","  background-color: #3d50c3;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row3_col6, #T_f0766_row6_col3 {\n","  background-color: #ba162b;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row3_col7, #T_f0766_row7_col3 {\n","  background-color: #b8122a;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row4_col0 {\n","  background-color: #5875e1;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row4_col2, #T_f0766_row7_col0 {\n","  background-color: #7a9df8;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row4_col6, #T_f0766_row4_col7, #T_f0766_row5_col6, #T_f0766_row8_col6 {\n","  background-color: #465ecf;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row4_col8 {\n","  background-color: #6788ee;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row5_col0 {\n","  background-color: #5572df;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row5_col1 {\n","  background-color: #3e51c5;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row5_col2 {\n","  background-color: #7b9ff9;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row5_col8 {\n","  background-color: #86a9fc;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row6_col0 {\n","  background-color: #80a3fa;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row6_col7, #T_f0766_row7_col6 {\n","  background-color: #b70d28;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row7_col2 {\n","  background-color: #6687ed;\n","  color: #f1f1f1;\n","}\n","#T_f0766_row7_col8 {\n","  background-color: #7093f3;\n","  color: #f1f1f1;\n","}\n","</style>\n","<table id=\"T_f0766_\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th class=\"blank level0\" >&nbsp;</th>\n","      <th class=\"col_heading level0 col0\" >SeriousDlqin2yrs</th>\n","      <th class=\"col_heading level0 col1\" >RevolvingUtilizationOfUnsecuredLines</th>\n","      <th class=\"col_heading level0 col2\" >age</th>\n","      <th class=\"col_heading level0 col3\" >NumberOfTime30-59DaysPastDueNotWorse</th>\n","      <th class=\"col_heading level0 col4\" >DebtRatio</th>\n","      <th class=\"col_heading level0 col5\" >MonthlyIncome</th>\n","      <th class=\"col_heading level0 col6\" >NumberOfTimes90DaysLate</th>\n","      <th class=\"col_heading level0 col7\" >NumberOfTime60-89DaysPastDueNotWorse</th>\n","      <th class=\"col_heading level0 col8\" >NumberOfDependents</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th id=\"T_f0766_level0_row0\" class=\"row_heading level0 row0\" >SeriousDlqin2yrs</th>\n","      <td id=\"T_f0766_row0_col0\" class=\"data row0 col0\" >1.000000</td>\n","      <td id=\"T_f0766_row0_col1\" class=\"data row0 col1\" >-0.001818</td>\n","      <td id=\"T_f0766_row0_col2\" class=\"data row0 col2\" >-0.115721</td>\n","      <td id=\"T_f0766_row0_col3\" class=\"data row0 col3\" >0.131517</td>\n","      <td id=\"T_f0766_row0_col4\" class=\"data row0 col4\" >-0.007719</td>\n","      <td id=\"T_f0766_row0_col5\" class=\"data row0 col5\" >-0.017262</td>\n","      <td id=\"T_f0766_row0_col6\" class=\"data row0 col6\" >0.122495</td>\n","      <td id=\"T_f0766_row0_col7\" class=\"data row0 col7\" >0.106257</td>\n","      <td id=\"T_f0766_row0_col8\" class=\"data row0 col8\" >0.046538</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f0766_level0_row1\" class=\"row_heading level0 row1\" >RevolvingUtilizationOfUnsecuredLines</th>\n","      <td id=\"T_f0766_row1_col0\" class=\"data row1 col0\" >-0.001818</td>\n","      <td id=\"T_f0766_row1_col1\" class=\"data row1 col1\" >1.000000</td>\n","      <td id=\"T_f0766_row1_col2\" class=\"data row1 col2\" >-0.005940</td>\n","      <td id=\"T_f0766_row1_col3\" class=\"data row1 col3\" >-0.001290</td>\n","      <td id=\"T_f0766_row1_col4\" class=\"data row1 col4\" >0.003946</td>\n","      <td id=\"T_f0766_row1_col5\" class=\"data row1 col5\" >0.006501</td>\n","      <td id=\"T_f0766_row1_col6\" class=\"data row1 col6\" >-0.001012</td>\n","      <td id=\"T_f0766_row1_col7\" class=\"data row1 col7\" >-0.000997</td>\n","      <td id=\"T_f0766_row1_col8\" class=\"data row1 col8\" >0.001134</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f0766_level0_row2\" class=\"row_heading level0 row2\" >age</th>\n","      <td id=\"T_f0766_row2_col0\" class=\"data row2 col0\" >-0.115721</td>\n","      <td id=\"T_f0766_row2_col1\" class=\"data row2 col1\" >-0.005940</td>\n","      <td id=\"T_f0766_row2_col2\" class=\"data row2 col2\" >1.000000</td>\n","      <td id=\"T_f0766_row2_col3\" class=\"data row2 col3\" >-0.055190</td>\n","      <td id=\"T_f0766_row2_col4\" class=\"data row2 col4\" >0.024191</td>\n","      <td id=\"T_f0766_row2_col5\" class=\"data row2 col5\" >0.027205</td>\n","      <td id=\"T_f0766_row2_col6\" class=\"data row2 col6\" >-0.052953</td>\n","      <td id=\"T_f0766_row2_col7\" class=\"data row2 col7\" >-0.048733</td>\n","      <td id=\"T_f0766_row2_col8\" class=\"data row2 col8\" >-0.217500</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f0766_level0_row3\" class=\"row_heading level0 row3\" >NumberOfTime30-59DaysPastDueNotWorse</th>\n","      <td id=\"T_f0766_row3_col0\" class=\"data row3 col0\" >0.131517</td>\n","      <td id=\"T_f0766_row3_col1\" class=\"data row3 col1\" >-0.001290</td>\n","      <td id=\"T_f0766_row3_col2\" class=\"data row3 col2\" >-0.055190</td>\n","      <td id=\"T_f0766_row3_col3\" class=\"data row3 col3\" >1.000000</td>\n","      <td id=\"T_f0766_row3_col4\" class=\"data row3 col4\" >-0.005912</td>\n","      <td id=\"T_f0766_row3_col5\" class=\"data row3 col5\" >-0.008380</td>\n","      <td id=\"T_f0766_row3_col6\" class=\"data row3 col6\" >0.980489</td>\n","      <td id=\"T_f0766_row3_col7\" class=\"data row3 col7\" >0.984535</td>\n","      <td id=\"T_f0766_row3_col8\" class=\"data row3 col8\" >-0.000299</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f0766_level0_row4\" class=\"row_heading level0 row4\" >DebtRatio</th>\n","      <td id=\"T_f0766_row4_col0\" class=\"data row4 col0\" >-0.007719</td>\n","      <td id=\"T_f0766_row4_col1\" class=\"data row4 col1\" >0.003946</td>\n","      <td id=\"T_f0766_row4_col2\" class=\"data row4 col2\" >0.024191</td>\n","      <td id=\"T_f0766_row4_col3\" class=\"data row4 col3\" >-0.005912</td>\n","      <td id=\"T_f0766_row4_col4\" class=\"data row4 col4\" >1.000000</td>\n","      <td id=\"T_f0766_row4_col5\" class=\"data row4 col5\" >-0.018105</td>\n","      <td id=\"T_f0766_row4_col6\" class=\"data row4 col6\" >-0.007823</td>\n","      <td id=\"T_f0766_row4_col7\" class=\"data row4 col7\" >-0.006963</td>\n","      <td id=\"T_f0766_row4_col8\" class=\"data row4 col8\" >-0.044983</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f0766_level0_row5\" class=\"row_heading level0 row5\" >MonthlyIncome</th>\n","      <td id=\"T_f0766_row5_col0\" class=\"data row5 col0\" >-0.017262</td>\n","      <td id=\"T_f0766_row5_col1\" class=\"data row5 col1\" >0.006501</td>\n","      <td id=\"T_f0766_row5_col2\" class=\"data row5 col2\" >0.027205</td>\n","      <td id=\"T_f0766_row5_col3\" class=\"data row5 col3\" >-0.008380</td>\n","      <td id=\"T_f0766_row5_col4\" class=\"data row5 col4\" >-0.018105</td>\n","      <td id=\"T_f0766_row5_col5\" class=\"data row5 col5\" >1.000000</td>\n","      <td id=\"T_f0766_row5_col6\" class=\"data row5 col6\" >-0.010689</td>\n","      <td id=\"T_f0766_row5_col7\" class=\"data row5 col7\" >-0.009328</td>\n","      <td id=\"T_f0766_row5_col8\" class=\"data row5 col8\" >0.066007</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f0766_level0_row6\" class=\"row_heading level0 row6\" >NumberOfTimes90DaysLate</th>\n","      <td id=\"T_f0766_row6_col0\" class=\"data row6 col0\" >0.122495</td>\n","      <td id=\"T_f0766_row6_col1\" class=\"data row6 col1\" >-0.001012</td>\n","      <td id=\"T_f0766_row6_col2\" class=\"data row6 col2\" >-0.052953</td>\n","      <td id=\"T_f0766_row6_col3\" class=\"data row6 col3\" >0.980489</td>\n","      <td id=\"T_f0766_row6_col4\" class=\"data row6 col4\" >-0.007823</td>\n","      <td id=\"T_f0766_row6_col5\" class=\"data row6 col5\" >-0.010689</td>\n","      <td id=\"T_f0766_row6_col6\" class=\"data row6 col6\" >1.000000</td>\n","      <td id=\"T_f0766_row6_col7\" class=\"data row6 col7\" >0.991409</td>\n","      <td id=\"T_f0766_row6_col8\" class=\"data row6 col8\" >-0.008209</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f0766_level0_row7\" class=\"row_heading level0 row7\" >NumberOfTime60-89DaysPastDueNotWorse</th>\n","      <td id=\"T_f0766_row7_col0\" class=\"data row7 col0\" >0.106257</td>\n","      <td id=\"T_f0766_row7_col1\" class=\"data row7 col1\" >-0.000997</td>\n","      <td id=\"T_f0766_row7_col2\" class=\"data row7 col2\" >-0.048733</td>\n","      <td id=\"T_f0766_row7_col3\" class=\"data row7 col3\" >0.984535</td>\n","      <td id=\"T_f0766_row7_col4\" class=\"data row7 col4\" >-0.006963</td>\n","      <td id=\"T_f0766_row7_col5\" class=\"data row7 col5\" >-0.009328</td>\n","      <td id=\"T_f0766_row7_col6\" class=\"data row7 col6\" >0.991409</td>\n","      <td id=\"T_f0766_row7_col7\" class=\"data row7 col7\" >1.000000</td>\n","      <td id=\"T_f0766_row7_col8\" class=\"data row7 col8\" >-0.008975</td>\n","    </tr>\n","    <tr>\n","      <th id=\"T_f0766_level0_row8\" class=\"row_heading level0 row8\" >NumberOfDependents</th>\n","      <td id=\"T_f0766_row8_col0\" class=\"data row8 col0\" >0.046538</td>\n","      <td id=\"T_f0766_row8_col1\" class=\"data row8 col1\" >0.001134</td>\n","      <td id=\"T_f0766_row8_col2\" class=\"data row8 col2\" >-0.217500</td>\n","      <td id=\"T_f0766_row8_col3\" class=\"data row8 col3\" >-0.000299</td>\n","      <td id=\"T_f0766_row8_col4\" class=\"data row8 col4\" >-0.044983</td>\n","      <td id=\"T_f0766_row8_col5\" class=\"data row8 col5\" >0.066007</td>\n","      <td id=\"T_f0766_row8_col6\" class=\"data row8 col6\" >-0.008209</td>\n","      <td id=\"T_f0766_row8_col7\" class=\"data row8 col7\" >-0.008975</td>\n","      <td id=\"T_f0766_row8_col8\" class=\"data row8 col8\" >1.000000</td>\n","    </tr>\n","  </tbody>\n","</table>\n"]},"metadata":{},"execution_count":25}],"source":["corr = data.corr()\n","corr.style.background_gradient(cmap='coolwarm')"]},{"cell_type":"markdown","metadata":{"id":"eU5cIsU_fcRF"},"source":["Сформируем матрицу X объект-признак и вектор y целевой переменной."]},{"cell_type":"code","execution_count":26,"metadata":{"executionInfo":{"elapsed":400,"status":"ok","timestamp":1677556998103,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"PGkd7qVzfd8i"},"outputs":[],"source":["X = data.drop('SeriousDlqin2yrs', axis=1) \n","y = data['SeriousDlqin2yrs'] "]},{"cell_type":"code","execution_count":27,"metadata":{"executionInfo":{"elapsed":1109,"status":"ok","timestamp":1677557000519,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"Y_GP62jD-Pca"},"outputs":[],"source":["data.to_csv(\"SeriousDlqin2yrs_Credit_Score.csv\", index=False)"]},{"cell_type":"markdown","metadata":{"id":"zdjTPyEfxfEr"},"source":["**3. Обучение модели**"]},{"cell_type":"markdown","metadata":{"id":"vfJHjepWf3u8"},"source":["Мы разбиваем данные на train и test"]},{"cell_type":"code","execution_count":28,"metadata":{"executionInfo":{"elapsed":275,"status":"ok","timestamp":1677557002525,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"mTwulwtLf9HD"},"outputs":[],"source":["from sklearn.metrics import accuracy_score\n","from sklearn.model_selection import train_test_split\n","\n","Xtrain, Xtest, ytrain, ytest = train_test_split(X, y, test_size=0.25, random_state=42)"]},{"cell_type":"code","execution_count":29,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":287},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1677557004284,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"Sydjnaeoxsal","outputId":"d1f7bbd6-65f5-451c-c6d0-d96275ca01c1"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   RevolvingUtilizationOfUnsecuredLines  age  \\\n","0                              0.766127   45   \n","1                              0.957151   40   \n","2                              0.658180   38   \n","3                              0.233810   30   \n","4                              0.907239   49   \n","\n","   NumberOfTime30-59DaysPastDueNotWorse  DebtRatio  MonthlyIncome  \\\n","0                                     2   0.802982         9120.0   \n","1                                     0   0.121876         2600.0   \n","2                                     1   0.085113         3042.0   \n","3                                     0   0.036050         3300.0   \n","4                                     1   0.024926        63588.0   \n","\n","   NumberOfTimes90DaysLate  NumberOfTime60-89DaysPastDueNotWorse  \\\n","0                        0                                     0   \n","1                        0                                     0   \n","2                        1                                     0   \n","3                        0                                     0   \n","4                        0                                     0   \n","\n","   NumberOfDependents  \n","0                 2.0  \n","1                 1.0  \n","2                 0.0  \n","3                 0.0  \n","4                 0.0  "],"text/html":["\n","  <div id=\"df-e5263d9a-5f23-492d-8b9f-5e0a2c1dcd33\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>RevolvingUtilizationOfUnsecuredLines</th>\n","      <th>age</th>\n","      <th>NumberOfTime30-59DaysPastDueNotWorse</th>\n","      <th>DebtRatio</th>\n","      <th>MonthlyIncome</th>\n","      <th>NumberOfTimes90DaysLate</th>\n","      <th>NumberOfTime60-89DaysPastDueNotWorse</th>\n","      <th>NumberOfDependents</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0.766127</td>\n","      <td>45</td>\n","      <td>2</td>\n","      <td>0.802982</td>\n","      <td>9120.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0.957151</td>\n","      <td>40</td>\n","      <td>0</td>\n","      <td>0.121876</td>\n","      <td>2600.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0.658180</td>\n","      <td>38</td>\n","      <td>1</td>\n","      <td>0.085113</td>\n","      <td>3042.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0.233810</td>\n","      <td>30</td>\n","      <td>0</td>\n","      <td>0.036050</td>\n","      <td>3300.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0.907239</td>\n","      <td>49</td>\n","      <td>1</td>\n","      <td>0.024926</td>\n","      <td>63588.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e5263d9a-5f23-492d-8b9f-5e0a2c1dcd33')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e5263d9a-5f23-492d-8b9f-5e0a2c1dcd33 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e5263d9a-5f23-492d-8b9f-5e0a2c1dcd33');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":29}],"source":["X.head()"]},{"cell_type":"markdown","metadata":{"id":"9NM1khuagrBk"},"source":["Отмасштабируем признаки при помощи StandardScaler"]},{"cell_type":"code","execution_count":30,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":287},"executionInfo":{"elapsed":300,"status":"ok","timestamp":1677557006683,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"vDxBQn52gs91","outputId":"b8d9d7af-401f-402a-d4c5-ba99c12321c5"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   RevolvingUtilizationOfUnsecuredLines       age  \\\n","0                             -0.022107  1.201036   \n","1                             -0.024166  1.676242   \n","2                             -0.022649 -0.020920   \n","3                             -0.024210 -0.496125   \n","4                             -0.022258 -0.835557   \n","\n","   NumberOfTime30-59DaysPastDueNotWorse  DebtRatio  MonthlyIncome  \\\n","0                             -0.101731  -0.173357       0.430620   \n","1                             -0.101731  -0.146922      -0.078595   \n","2                             -0.101731  -0.173017      -0.448934   \n","3                             -0.101731  -0.173392      -0.032303   \n","4                             -0.101731  -0.173190       0.154101   \n","\n","   NumberOfTimes90DaysLate  NumberOfTime60-89DaysPastDueNotWorse  \\\n","0                -0.062544                             -0.055916   \n","1                -0.062544                             -0.055916   \n","2                -0.062544                             -0.055916   \n","3                -0.062544                             -0.055916   \n","4                -0.062544                             -0.055916   \n","\n","   NumberOfDependents  \n","0            0.234966  \n","1           -0.667331  \n","2           -0.667331  \n","3            0.234966  \n","4           -0.667331  "],"text/html":["\n","  <div id=\"df-a1248673-c6e1-42ee-b9ca-18fc22ee5012\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>RevolvingUtilizationOfUnsecuredLines</th>\n","      <th>age</th>\n","      <th>NumberOfTime30-59DaysPastDueNotWorse</th>\n","      <th>DebtRatio</th>\n","      <th>MonthlyIncome</th>\n","      <th>NumberOfTimes90DaysLate</th>\n","      <th>NumberOfTime60-89DaysPastDueNotWorse</th>\n","      <th>NumberOfDependents</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>-0.022107</td>\n","      <td>1.201036</td>\n","      <td>-0.101731</td>\n","      <td>-0.173357</td>\n","      <td>0.430620</td>\n","      <td>-0.062544</td>\n","      <td>-0.055916</td>\n","      <td>0.234966</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>-0.024166</td>\n","      <td>1.676242</td>\n","      <td>-0.101731</td>\n","      <td>-0.146922</td>\n","      <td>-0.078595</td>\n","      <td>-0.062544</td>\n","      <td>-0.055916</td>\n","      <td>-0.667331</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>-0.022649</td>\n","      <td>-0.020920</td>\n","      <td>-0.101731</td>\n","      <td>-0.173017</td>\n","      <td>-0.448934</td>\n","      <td>-0.062544</td>\n","      <td>-0.055916</td>\n","      <td>-0.667331</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>-0.024210</td>\n","      <td>-0.496125</td>\n","      <td>-0.101731</td>\n","      <td>-0.173392</td>\n","      <td>-0.032303</td>\n","      <td>-0.062544</td>\n","      <td>-0.055916</td>\n","      <td>0.234966</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>-0.022258</td>\n","      <td>-0.835557</td>\n","      <td>-0.101731</td>\n","      <td>-0.173190</td>\n","      <td>0.154101</td>\n","      <td>-0.062544</td>\n","      <td>-0.055916</td>\n","      <td>-0.667331</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a1248673-c6e1-42ee-b9ca-18fc22ee5012')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a1248673-c6e1-42ee-b9ca-18fc22ee5012 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a1248673-c6e1-42ee-b9ca-18fc22ee5012');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":30}],"source":["import pandas as pd\n","from sklearn.preprocessing import StandardScaler\n","\n","ss = StandardScaler()\n","ss.fit(Xtrain)\n","\n","Xtrain = pd.DataFrame(ss.transform(Xtrain), columns=X.columns)\n","Xtest = pd.DataFrame(ss.transform(Xtest), columns=X.columns)\n","\n","Xtrain.head()"]},{"cell_type":"markdown","metadata":{"id":"BU9-iUsmg9M8"},"source":["Обучим логистическую регрессию на train и сделаем предсказание на новых для нее данных (test)"]},{"cell_type":"code","execution_count":31,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":642,"status":"ok","timestamp":1677557009900,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"3enzbQePj4x9","outputId":"0a3768c1-3483-48ad-c35c-356f6bfa51ba"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["LogisticRegression()"]},"metadata":{},"execution_count":31}],"source":["from sklearn.linear_model import LogisticRegression\n","\n","model = LogisticRegression() \n","model.fit(Xtrain, ytrain)"]},{"cell_type":"code","execution_count":32,"metadata":{"executionInfo":{"elapsed":330,"status":"ok","timestamp":1677557011597,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"_AqEWWv6x6uv"},"outputs":[],"source":["pred_test = model.predict(Xtest)"]},{"cell_type":"code","execution_count":33,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":444,"status":"ok","timestamp":1677557014168,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"8mg0W7Zkx-gc","outputId":"e5fbbb1a-6e81-4371-88ea-016797470af0"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0, 0, 0, ..., 0, 0, 0])"]},"metadata":{},"execution_count":33}],"source":["pred_test"]},{"cell_type":"code","execution_count":34,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":20,"status":"ok","timestamp":1677557015745,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"d5Oiow7ayBus","outputId":"dc2c59d6-dafd-4c05-a9b3-6a4781dbd572"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.9341865695619578"]},"metadata":{},"execution_count":34}],"source":["accuracy_score(ytest, pred_test)"]},{"cell_type":"markdown","metadata":{"id":"3U24M-tH_e2T"},"source":["Проверим сбалансирована ли выборка"]},{"cell_type":"code","execution_count":35,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1677557017869,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"cXUAHOgH_izC","outputId":"0e29ba00-a17c-4b17-8a93-29e7c995441f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    139382\n","1     10009\n","Name: SeriousDlqin2yrs, dtype: int64"]},"metadata":{},"execution_count":35}],"source":["y.value_counts()"]},{"cell_type":"markdown","metadata":{"id":"SodL5tB6_osl"},"source":["Предсказания модели"]},{"cell_type":"code","execution_count":36,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":282,"status":"ok","timestamp":1677557020999,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"Xf0DHjt3_qiZ","outputId":"6a2cf74e-dd06-4835-ff5e-fb9ca02038c2"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])"]},"metadata":{},"execution_count":36}],"source":["pred_test[:20]"]},{"cell_type":"markdown","metadata":{"id":"iaj73zqo_0oV"},"source":["4.Валидация"]},{"cell_type":"code","execution_count":37,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":272,"status":"ok","timestamp":1677557024276,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"aLfBw0gEAEsr","outputId":"f4105fa8-b272-4998-efce-518ad37797f8"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[34794,    63],\n","       [ 2395,    96]])"]},"metadata":{},"execution_count":37}],"source":["from sklearn.metrics import confusion_matrix\n","\n","confusion_matrix(ytest, pred_test)"]},{"cell_type":"code","execution_count":38,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":374,"status":"ok","timestamp":1677557027353,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"CoRodx4zAIZi","outputId":"e33ba0f7-567d-4edc-b4c4-0e462644822c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    34857\n","1     2491\n","Name: SeriousDlqin2yrs, dtype: int64"]},"metadata":{},"execution_count":38}],"source":["ytest.value_counts()"]},{"cell_type":"code","execution_count":39,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1677557028844,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"Z5m2tT-MAPlR","outputId":"bb37b435-658e-4293-a481-56cc8a59cfdd"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.03853873946206343"]},"metadata":{},"execution_count":39}],"source":["from sklearn.metrics import recall_score\n","\n","recall_score(ytest, pred_test)"]},{"cell_type":"markdown","metadata":{"id":"a-QgAsvXAUTh"},"source":["Вероятности выдаваемые моделью"]},{"cell_type":"code","execution_count":40,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1677557030606,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"TT4OCTr8AZ8M","outputId":"dd33cc3f-36ab-4c63-d345-4a28d085571f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0.97978656, 0.02021344],\n","       [0.977466  , 0.022534  ],\n","       [0.97041354, 0.02958646],\n","       [0.90605547, 0.09394453],\n","       [0.89242263, 0.10757737],\n","       [0.96813693, 0.03186307],\n","       [0.91344341, 0.08655659],\n","       [0.96763513, 0.03236487],\n","       [0.91213523, 0.08786477],\n","       [0.98186546, 0.01813454]])"]},"metadata":{},"execution_count":40}],"source":["probs = model.predict_proba(Xtest)\n","\n","probs[:10]"]},{"cell_type":"markdown","metadata":{"id":"-txBp9rkAfxb"},"source":["Снизим порог"]},{"cell_type":"code","execution_count":41,"metadata":{"executionInfo":{"elapsed":266,"status":"ok","timestamp":1677557032889,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"Z4cQUAUDAfPg"},"outputs":[],"source":["probs_SeriousDlqin2yrs = probs[:,1]\n","\n","classes = probs_SeriousDlqin2yrs > 0.2"]},{"cell_type":"code","execution_count":42,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":470,"status":"ok","timestamp":1677557035423,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"NsrAW9wjAv5d","outputId":"0285e291-f6e9-4933-f188-13ceced3cb4b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[34333,   524],\n","       [ 2052,   439]])"]},"metadata":{},"execution_count":42}],"source":["confusion_matrix(ytest, classes)"]},{"cell_type":"code","execution_count":44,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":438,"status":"ok","timestamp":1677557039674,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"tQJ4Z5pAA0NU","outputId":"bb524b9c-cbf7-496b-bad5-9531754fdd3c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    34857\n","1     2491\n","Name: SeriousDlqin2yrs, dtype: int64"]},"metadata":{},"execution_count":44}],"source":["ytest.value_counts()"]},{"cell_type":"code","execution_count":45,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":394,"status":"ok","timestamp":1677557041545,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"A9fHR9GlA3HE","outputId":"700478f4-b479-4c99-bd2c-98c1e97fb85e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.17623444399839422"]},"metadata":{},"execution_count":45}],"source":["recall_score(ytest, classes)"]},{"cell_type":"markdown","metadata":{"id":"P1WxP9_0A8sh"},"source":["**5.Интерпритация**"]},{"cell_type":"code","execution_count":46,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":269,"status":"ok","timestamp":1677557044147,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"0AWtlS3WBBVV","outputId":"64d61870-f439-4e8f-b0e4-ef9201b7b752"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(array([[-0.00587974, -0.42319779,  1.88417668, -0.03113527, -0.3860687 ,\n","          1.75967401, -3.47253373,  0.09231829]]), array([-2.84335527]))"]},"metadata":{},"execution_count":46}],"source":["model.coef_, model.intercept_"]},{"cell_type":"code","execution_count":47,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":300},"executionInfo":{"elapsed":474,"status":"ok","timestamp":1677557046681,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"s6R7V2q4BGlr","outputId":"b7cb8638-4072-4865-f3ad-977ed790955e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                               features   weights\n","6  NumberOfTime60-89DaysPastDueNotWorse -3.472534\n","1                                   age -0.423198\n","4                         MonthlyIncome -0.386069\n","3                             DebtRatio -0.031135\n","0  RevolvingUtilizationOfUnsecuredLines -0.005880\n","7                    NumberOfDependents  0.092318\n","5               NumberOfTimes90DaysLate  1.759674\n","2  NumberOfTime30-59DaysPastDueNotWorse  1.884177"],"text/html":["\n","  <div id=\"df-537e76fd-d869-4d1f-bc58-b1e7cdf085ee\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>features</th>\n","      <th>weights</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>6</th>\n","      <td>NumberOfTime60-89DaysPastDueNotWorse</td>\n","      <td>-3.472534</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>age</td>\n","      <td>-0.423198</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>MonthlyIncome</td>\n","      <td>-0.386069</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>DebtRatio</td>\n","      <td>-0.031135</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>RevolvingUtilizationOfUnsecuredLines</td>\n","      <td>-0.005880</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>NumberOfDependents</td>\n","      <td>0.092318</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>NumberOfTimes90DaysLate</td>\n","      <td>1.759674</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>NumberOfTime30-59DaysPastDueNotWorse</td>\n","      <td>1.884177</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-537e76fd-d869-4d1f-bc58-b1e7cdf085ee')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-537e76fd-d869-4d1f-bc58-b1e7cdf085ee button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-537e76fd-d869-4d1f-bc58-b1e7cdf085ee');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":47}],"source":["import pandas as pd\n","\n","coef_table = pd.DataFrame({'features' : list(X.columns), 'weights' : list(model.coef_[0])})\n","\n","coef_table.sort_values(by='weights')"]},{"cell_type":"markdown","metadata":{"id":"bppejTooBLSf"},"source":["Метод ближайших соседей"]},{"cell_type":"code","execution_count":48,"metadata":{"executionInfo":{"elapsed":4,"status":"ok","timestamp":1677557049179,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"URMb39nEBGih"},"outputs":[],"source":["from sklearn.neighbors import KNeighborsClassifier\n","\n","knn = KNeighborsClassifier()"]},{"cell_type":"code","execution_count":49,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5428,"status":"ok","timestamp":1677557056105,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"G7j9ItzXBQ2X","outputId":"9976d3e1-f549-4166-d62c-5eaadad13801"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[28210,  6647],\n","       [ 1080,  1411]])"]},"metadata":{},"execution_count":49}],"source":["knn.fit(Xtrain, ytrain)\n","\n","pred_test2 = knn.predict_proba(Xtest)[:,1]\n","\n","classes2 = pred_test2 > 0.1\n","\n","confusion_matrix(ytest, classes2)"]},{"cell_type":"markdown","metadata":{"id":"McXzI6L2Bakl"},"source":["Сохранение предсказаний модеил в файл"]},{"cell_type":"code","execution_count":50,"metadata":{"executionInfo":{"elapsed":22,"status":"ok","timestamp":1677557056106,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"ZLPj1CWLBdpq"},"outputs":[],"source":["Xtest['predictions'] = probs_SeriousDlqin2yrs\n","\n","Xtest[['predictions']].to_csv(\"PredictionsSeriousDlqin2yrs.csv\", index=False)"]},{"cell_type":"markdown","metadata":{"id":"XQPmieJnBag4"},"source":["И саму модель в Pickle"]},{"cell_type":"code","execution_count":51,"metadata":{"executionInfo":{"elapsed":322,"status":"ok","timestamp":1677557061687,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"},"user_tz":-360},"id":"tTMywr0hB0Vu"},"outputs":[],"source":["import pickle \n","\n","with open('model.pickle', 'wb') as f:\n","    pickle.dump(model, f)"]},{"cell_type":"markdown","metadata":{"id":"pp2nS2epEwob"},"source":["Градиентный бустинг"]},{"cell_type":"code","execution_count":71,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Z48_VwqTEz9g","executionInfo":{"status":"ok","timestamp":1677557565910,"user_tz":-360,"elapsed":297,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"}},"outputId":"a8a607ed-f31b-4954-a218-0b289c38b0ef"},"outputs":[{"output_type":"stream","name":"stdout","text":["LR quality:\n","precision:  0.45586708203530635\n","recall:  0.17623444399839422\n","auc-roc:  0.7077917200432617\n"]}],"source":["from sklearn import metrics\n","\n","print(\"LR quality:\")\n","print(\"precision: \", metrics.precision_score(ytest, classes))\n","print(\"recall: \", metrics.recall_score(ytest, classes))\n","print(\"auc-roc: \", metrics.roc_auc_score(ytest, probs[:, 1]))"]},{"cell_type":"code","source":["!pip install catboost"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6ZVvbukWMxOs","executionInfo":{"status":"ok","timestamp":1677557571816,"user_tz":-360,"elapsed":3124,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"}},"outputId":"d7261ea7-c1d7-4ad8-bf75-d1e20cc4bac8"},"execution_count":72,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: catboost in /usr/local/lib/python3.8/dist-packages (1.1.1)\n","Requirement already satisfied: pandas>=0.24.0 in /usr/local/lib/python3.8/dist-packages (from catboost) (1.3.5)\n","Requirement already satisfied: numpy>=1.16.0 in /usr/local/lib/python3.8/dist-packages (from catboost) (1.22.4)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.8/dist-packages (from catboost) (1.7.3)\n","Requirement already satisfied: six in /usr/local/lib/python3.8/dist-packages (from catboost) (1.15.0)\n","Requirement already satisfied: plotly in /usr/local/lib/python3.8/dist-packages (from catboost) (5.5.0)\n","Requirement already satisfied: graphviz in /usr/local/lib/python3.8/dist-packages (from catboost) (0.10.1)\n","Requirement already satisfied: matplotlib in /usr/local/lib/python3.8/dist-packages (from catboost) (3.5.3)\n","Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.8/dist-packages (from pandas>=0.24.0->catboost) (2.8.2)\n","Requirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.8/dist-packages (from pandas>=0.24.0->catboost) (2022.7.1)\n","Requirement already satisfied: pyparsing>=2.2.1 in /usr/local/lib/python3.8/dist-packages (from matplotlib->catboost) (3.0.9)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.8/dist-packages (from matplotlib->catboost) (1.4.4)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.8/dist-packages (from matplotlib->catboost) (8.4.0)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.8/dist-packages (from matplotlib->catboost) (0.11.0)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.8/dist-packages (from matplotlib->catboost) (4.38.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.8/dist-packages (from matplotlib->catboost) (23.0)\n","Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.8/dist-packages (from plotly->catboost) (8.2.1)\n"]}]},{"cell_type":"code","source":["from catboost import CatBoostClassifier, Pool"],"metadata":{"id":"K1hWF19VM0ll","executionInfo":{"status":"ok","timestamp":1677557574227,"user_tz":-360,"elapsed":4,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"}}},"execution_count":73,"outputs":[]},{"cell_type":"code","source":["train_set = Pool(Xtrain, ytrain)\n","test_set = Pool(Xtest, ytest)"],"metadata":{"id":"8epjArunM3Xq","executionInfo":{"status":"ok","timestamp":1677557575928,"user_tz":-360,"elapsed":4,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"}}},"execution_count":74,"outputs":[]},{"cell_type":"code","source":["gbm = CatBoostClassifier(iterations=100,\n","                          depth=2,\n","                          learning_rate=0.1,\n","                          loss_function='Logloss',\n","                          eval_metric='AUC',\n","                          verbose=False)\n","gbm.fit(train_set, eval_set=test_set)\n","gbm_preds = gbm.predict_proba(Xtest)"],"metadata":{"id":"LA8StYRZOYgu","executionInfo":{"status":"error","timestamp":1677557600759,"user_tz":-360,"elapsed":309,"user":{"displayName":"Benjamin Busygin","userId":"04576268126649352985"}},"outputId":"9af754f9-5e3d-4ca9-f09b-27c29b82973f","colab":{"base_uri":"https://localhost:8080/","height":432}},"execution_count":76,"outputs":[{"output_type":"error","ename":"CatBoostError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mCatBoostError\u001b[0m                             Traceback (most recent call last)","\u001b[0;32m<ipython-input-76-d81767ac2fac>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      5\u001b[0m                           \u001b[0meval_metric\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'AUC'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m                           verbose=False)\n\u001b[0;32m----> 7\u001b[0;31m \u001b[0mgbm\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtrain_set\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0meval_set\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtest_set\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      8\u001b[0m \u001b[0mgbm_preds\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mgbm\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpredict_proba\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mXtest\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.8/dist-packages/catboost/core.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, X, y, cat_features, text_features, embedding_features, sample_weight, baseline, use_best_model, eval_set, verbose, logging_level, plot, plot_file, column_description, verbose_eval, metric_period, silent, early_stopping_rounds, save_snapshot, snapshot_file, snapshot_interval, init_model, callbacks, log_cout, log_cerr)\u001b[0m\n\u001b[1;32m   5126\u001b[0m             \u001b[0mCatBoostClassifier\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_check_is_compatible_loss\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mparams\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'loss_function'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5127\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5128\u001b[0;31m         self._fit(X, y, cat_features, text_features, embedding_features, None, sample_weight, None, None, None, None, baseline, use_best_model,\n\u001b[0m\u001b[1;32m   5129\u001b[0m                   \u001b[0meval_set\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mverbose\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlogging_level\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mplot\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mplot_file\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcolumn_description\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mverbose_eval\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmetric_period\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5130\u001b[0m                   silent, early_stopping_rounds, save_snapshot, snapshot_file, snapshot_interval, init_model, callbacks, log_cout, log_cerr)\n","\u001b[0;32m/usr/local/lib/python3.8/dist-packages/catboost/core.py\u001b[0m in \u001b[0;36m_fit\u001b[0;34m(self, X, y, cat_features, text_features, embedding_features, pairs, sample_weight, group_id, group_weight, subgroup_id, pairs_weight, baseline, use_best_model, eval_set, verbose, logging_level, plot, plot_file, column_description, verbose_eval, metric_period, silent, early_stopping_rounds, save_snapshot, snapshot_file, snapshot_interval, init_model, callbacks, log_cout, log_cerr)\u001b[0m\n\u001b[1;32m   2353\u001b[0m         \u001b[0;32mwith\u001b[0m \u001b[0mlog_fixup\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlog_cout\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlog_cerr\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m\\\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2354\u001b[0m             \u001b[0mplot_wrapper\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mplot\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mplot_file\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'Training plots'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0m_get_train_dir\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_params\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2355\u001b[0;31m             self._train(\n\u001b[0m\u001b[1;32m   2356\u001b[0m                 \u001b[0mtrain_pool\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2357\u001b[0m                 \u001b[0mtrain_params\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"eval_sets\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.8/dist-packages/catboost/core.py\u001b[0m in \u001b[0;36m_train\u001b[0;34m(self, train_pool, test_pool, params, allow_clear_pool, init_model)\u001b[0m\n\u001b[1;32m   1757\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1758\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_train\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtrain_pool\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtest_pool\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mparams\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mallow_clear_pool\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minit_model\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1759\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_object\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_train\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtrain_pool\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtest_pool\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mparams\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mallow_clear_pool\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minit_model\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_object\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0minit_model\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1760\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_set_trained_model_attributes\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1761\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m_catboost.pyx\u001b[0m in \u001b[0;36m_catboost._CatBoost._train\u001b[0;34m()\u001b[0m\n","\u001b[0;32m_catboost.pyx\u001b[0m in \u001b[0;36m_catboost._CatBoost._train\u001b[0;34m()\u001b[0m\n","\u001b[0;31mCatBoostError\u001b[0m: catboost/libs/data/features_layout.cpp:511: Feature #8 is used in data to quantize, but not available in quantized info"]}]}],"metadata":{"colab":{"provenance":[{"file_id":"18B1Kma8TZIYKbD3Ucjwj6I4z1EIBEjRx","timestamp":1677519521033}],"authorship_tag":"ABX9TyN2CtRxkNfhMdJp6jfgXCMK"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}